# AI çŸ¥è¯†åº“ç®¡ç†ç³»ç»Ÿ


![Version](https://img.shields.io/badge/version-1.0.0-blue.svg)
![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.5.7-brightgreen.svg)
![Vue](https://img.shields.io/badge/Vue-3.5.6-green.svg)
![License](https://img.shields.io/badge/license-MIT-orange.svg)

ä¸€ä¸ªåŸºäº Spring Boot + Vue 3 çš„æ™ºèƒ½çŸ¥è¯†åº“ç®¡ç†ç³»ç»Ÿï¼Œé›†æˆ AI å¯¹è¯ã€ç¬”è®°ç®¡ç†ã€æ€ç»´å¯¼å›¾ã€æ–‡ä»¶ç®¡ç†ç­‰åŠŸèƒ½ã€‚

---
- å‰ç«¯ï¼š[K-iitty/AIKnowledgeBaseFrontend: æ™ºèƒ½é—®ç­”çŸ¥è¯†åº“](https://github.com/K-iitty/AIKnowledgeBaseFrontend)
- åç«¯ï¼š[K-iitty/AIKnowledgeBaseBackend: æ™ºèƒ½é—®ç­”çŸ¥è¯†åº“](https://github.com/K-iitty/AIKnowledgeBaseBackend)

##  åŠŸèƒ½ç‰¹æ€§

### AI æ™ºèƒ½åŠ©æ‰‹
- **RAG æ£€ç´¢å¢å¼º**ï¼šåŸºäºç¬”è®°å’Œæ€ç»´å¯¼å›¾çš„æœ¬åœ°çŸ¥è¯†åº“é—®ç­”ï¼ŒConcurrentHashMap å†…å­˜ç´¢å¼• + å…³é”®è¯ç›¸å…³æ€§ç®—æ³•
- **å¼‚æ­¥ç´¢å¼•é‡å»º**ï¼š@Async æ³¨è§£ + è‡ªå®šä¹‰çº¿ç¨‹æ± ï¼Œæ¥å£å“åº”æ—¶é—´ä» 5-10 ç§’é™è‡³ 200ms
- **å¤šè½®å¯¹è¯**ï¼šåŒå­˜å‚¨ç­–ç•¥ï¼ˆå†…å­˜ + æ•°æ®åº“ï¼‰ï¼Œæ»‘åŠ¨çª—å£ä¿ç•™æœ€è¿‘ 20 æ¡æ¶ˆæ¯
- **æµå¼å“åº”**ï¼šSSE å®æ—¶æ¨é€ï¼Œè§£æ `delta.content` å®ç°æ‰“å­—æ•ˆæœ
- **ä¸‰çº§é™æµ**ï¼šå…¨å±€ 1000 QPS + AI æ¥å£ 50 QPS + ç”¨æˆ· 100 QPSï¼ŒGuava RateLimiter ä»¤ç‰Œæ¡¶ç®—æ³•

### ç¬”è®°ç®¡ç†
- **Markdown ç¼–è¾‘å™¨**ï¼šå®æ—¶é¢„è§ˆã€è¯­æ³•é«˜äº®ã€å›¾ç‰‡ä¸Šä¼ è‡³é˜¿é‡Œäº‘ OSS
- **Redis ç¼“å­˜**ï¼šCache-Aside ç­–ç•¥ï¼Œç¼“å­˜ç¬”è®°è¯¦æƒ…/å†…å®¹/åˆ—è¡¨ï¼Œæå‡æŸ¥è¯¢æ€§èƒ½
- **åˆ†ç±»ä¸æ ‡ç­¾**ï¼šæ ‘å½¢åˆ†ç±»ç»“æ„ï¼Œå¤šæ ‡ç­¾ç­›é€‰
- **æ–‡ä»¶å¯¼å…¥å¯¼å‡º**ï¼šæ”¯æŒ Markdownã€PDF æ ¼å¼

### æ€ç»´å¯¼å›¾
- **å¯è§†åŒ–ç¼–è¾‘**ï¼šåŸºäº jsMindï¼Œæ”¯æŒèŠ‚ç‚¹å¢åˆ æ”¹ã€å¤‡æ³¨ã€å›¾ç‰‡é™„ä»¶
- **XMind å…¼å®¹**ï¼šæ”¯æŒ XMind æ ¼å¼å¯¼å…¥å¯¼å‡º

### ç”¨æˆ·ç³»ç»Ÿ
- **JWT è®¤è¯**ï¼šæ— çŠ¶æ€ Tokenï¼ŒHS256 ç­¾åï¼ŒBCrypt å¯†ç åŠ å¯†
- **æ»‘åŠ¨éªŒè¯ç **ï¼šAJ-Captcha æ»‘å—æ‹¼å›¾ï¼ŒRedis ç¼“å­˜ï¼Œ120 ç§’è¿‡æœŸ
- **æƒé™æ§åˆ¶**ï¼šSpring Security + æ•°æ®éš”ç¦»ï¼ˆuser_id å­—æ®µï¼‰

## æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯
| æŠ€æœ¯ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|
| Spring Boot | 3.5.7 | æ ¸å¿ƒæ¡†æ¶ |
| Spring Security | 6.x | å®‰å…¨æ¡†æ¶ |
| MyBatis Plus | 3.5.5 | ORM æ¡†æ¶ |
| MySQL | 8.0+ | å…³ç³»å‹æ•°æ®åº“ |
| Redis | 7.x | ç¼“å­˜æ•°æ®åº“ |
| JWT | 0.11.5 | Token è®¤è¯ |
| Spring AI Alibaba | 1.0.0.2 | AI é›†æˆæ¡†æ¶ |
| é˜¿é‡Œäº‘ OSS | 3.17.4 | å¯¹è±¡å­˜å‚¨ |
| PDFBox | 2.0.30 | PDF å¤„ç† |
| Knife4j | 4.4.0 | API æ–‡æ¡£ |
| Lombok | 1.18.32 | ä»£ç ç®€åŒ– |
| AJ-Captcha | 1.3.0 | æ»‘åŠ¨éªŒè¯ç  |
| Guava | 32.1.3-jre | é™æµå·¥å…· |

### å‰ç«¯æŠ€æœ¯
| æŠ€æœ¯ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|
| Vue | 3.5.6 | å‰ç«¯æ¡†æ¶ |
| Vue Router | 4.4.5 | è·¯ç”±ç®¡ç† |
| Element Plus | 2.8.6 | UI ç»„ä»¶åº“ |
| Axios | 1.7.7 | HTTP å®¢æˆ·ç«¯ |
| Marked | 17.0.0 | Markdown è§£æ |
| jsMind | 0.8.5 | æ€ç»´å¯¼å›¾åº“ |
| Vite | 5.4.10 | æ„å»ºå·¥å…· |

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **JDK**: 17+
- **Node.js**: 16+
- **MySQL**: 8.0+
- **Redis**: 7.x+
- **Maven**: 3.6+

### åç«¯å¯åŠ¨

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <repository-url>
cd xian-AIKnowledgeBase/AIKnowledgeBaseBackend/AIKnowledgeBaseBackend
```

2. **é…ç½®æ•°æ®åº“**

åˆ›å»ºæ•°æ®åº“ï¼š
```sql
CREATE DATABASE aiknowledgebase CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

3. **ä¿®æ”¹é…ç½®æ–‡ä»¶**

ç¼–è¾‘ `src/main/resources/application.yml`ï¼š

```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/aiknowledgebase?useUnicode=true&characterEncoding=UTF-8&serverTimezone=Asia/Shanghai
    username: your_username
    password: your_password
  
  data:
    redis:
      host: localhost
      port: 6379
      password: your_redis_password
  
  ai:
    dashscope:
      api-key: your_dashscope_api_key  # é˜¿é‡Œäº‘é€šä¹‰åƒé—® API Key

# AJ-Captcha éªŒè¯ç é…ç½®
aj:
  captcha:
    type: blockPuzzle          # éªŒè¯ç ç±»å‹ï¼šæ»‘å—æ‹¼å›¾
    cache-type: redis          # ç¼“å­˜ç±»å‹ï¼šRedis
    expire-seconds: 120        # éªŒè¯ç æœ‰æ•ˆæœŸï¼ˆç§’ï¼‰
    slip-offset: 5             # æ»‘åŠ¨è¯¯å·®å…è®¸èŒƒå›´ï¼ˆåƒç´ ï¼‰
    aes-status: false          # AES åŠ å¯†çŠ¶æ€

aliyun:
  oss:
    endpoint: oss-cn-beijing.aliyuncs.com
    bucket-name: your_bucket_name
    access-key-id: ${OSS_ACCESS_KEY_ID}
    access-key-secret: ${OSS_ACCESS_KEY_SECRET}

jwt:
  secret: your_jwt_secret_key_at_least_256_bits_long
  expiration: 604800000  # 7å¤©
```

4. **è®¾ç½®ç¯å¢ƒå˜é‡**

```bash
# Windows
set OSS_ACCESS_KEY_ID=your_access_key_id
set OSS_ACCESS_KEY_SECRET=your_access_key_secret

# Linux/Mac
export OSS_ACCESS_KEY_ID=your_access_key_id
export OSS_ACCESS_KEY_SECRET=your_access_key_secret
```

5. **å¯åŠ¨åç«¯**

```bash
# ä½¿ç”¨ Maven
mvn clean install
mvn spring-boot:run

# æˆ–ä½¿ç”¨ IDE ç›´æ¥è¿è¡Œ AiKnowledgeBaseBackendApplication
```

åç«¯æœåŠ¡å°†åœ¨ `http://localhost:8081` å¯åŠ¨

### å‰ç«¯å¯åŠ¨

1. **è¿›å…¥å‰ç«¯ç›®å½•**
```bash
cd xian-AIKnowledgeBase/AIKnowledgeBaseFrontend
```

2. **å®‰è£…ä¾èµ–**
```bash
npm install
```

3. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**
```bash
npm run dev
```

å‰ç«¯æœåŠ¡å°†åœ¨ `http://localhost:5173` å¯åŠ¨

4. **æ„å»ºç”Ÿäº§ç‰ˆæœ¬**
```bash
npm run build
```

## é¡µé¢

![PixPin_2025-12-01_15-42-42](./assets/PixPin_2025-12-01_15-42-42.png)

![PixPin_2025-11-30_23-04-51](./assets/PixPin_2025-11-30_23-04-51.png)

![PixPin_2025-11-16_23-02-12](./assets/PixPin_2025-11-16_23-02-12.png)

![PixPin_2025-11-16_22-13-03](./assets/PixPin_2025-11-16_22-13-03.png)

![PixPin_2025-11-22_17-01-11](./assets/PixPin_2025-11-22_17-01-11.png)

![PixPin_2025-11-16_22-14-49](./assets/PixPin_2025-11-16_22-14-49.png)

![PixPin_2025-11-16_22-12-05](./assets/PixPin_2025-11-16_22-12-05.png)

![PixPin_2025-12-01_22-44-32](./assets/PixPin_2025-12-01_22-44-32.png)

![PixPin_2025-12-01_23-28-24](./assets/PixPin_2025-12-01_23-28-24.png)

![PixPin_2025-12-01_15-08-06](./assets/PixPin_2025-12-01_15-08-06.png)

![PixPin_2025-11-16_22-12-17](./assets/PixPin_2025-11-16_22-12-17.png)

![PixPin_2025-12-01_00-26-28](./assets/PixPin_2025-12-01_00-26-28.png)

![PixPin_2025-11-30_23-11-16](./assets/PixPin_2025-11-30_23-11-16.png)

##  é¡¹ç›®ç»“æ„

### åç«¯ç»“æ„

```
AIKnowledgeBaseBackend/
â”œâ”€â”€ src/main/java/com/fanfan/aiknowledgebasebackend/
â”‚   â”œâ”€â”€ common/
â”‚   â”‚   â”œâ”€â”€ config/          # é…ç½®ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ AsyncConfig.java          # å¼‚æ­¥ä»»åŠ¡é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ CaptchaConfig.java        # éªŒè¯ç é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ CorsConfig.java           # è·¨åŸŸé…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ GlobalExceptionHandler.java  # å…¨å±€å¼‚å¸¸å¤„ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ OssConfig.java            # OSS é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ SecurityConfig.java       # å®‰å…¨é…ç½®
â”‚   â”‚   â”‚   â””â”€â”€ WebMvcConfig.java         # Web MVC é…ç½®
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ interceptor/     # æ‹¦æˆªå™¨
â”‚   â”‚   â”‚   â””â”€â”€ RateLimitInterceptor.java  # é™æµæ‹¦æˆªå™¨
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ security/        # å®‰å…¨ç›¸å…³
â”‚   â”‚       â””â”€â”€ JwtAuthenticationFilter.java  # JWT è¿‡æ»¤å™¨
â”‚   â”‚
â”‚   â”œâ”€â”€ controller/          # æ§åˆ¶å™¨å±‚
â”‚   â”‚   â”œâ”€â”€ AiController.java         # AI å¯¹è¯æ¥å£
â”‚   â”‚   â”œâ”€â”€ AuthController.java       # è®¤è¯æ¥å£
â”‚   â”‚   â”œâ”€â”€ CategoryController.java   # åˆ†ç±»ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ FileController.java       # æ–‡ä»¶ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ LinkController.java       # é“¾æ¥ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ MindmapController.java    # æ€ç»´å¯¼å›¾
â”‚   â”‚   â”œâ”€â”€ NoteController.java       # ç¬”è®°ç®¡ç†
â”‚   â”‚   â””â”€â”€ ProfileController.java    # ä¸ªäººèµ„æ–™
â”‚   â”‚
â”‚   â”œâ”€â”€ dto/                 # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚   â”œâ”€â”€ ChatRequest.java
â”‚   â”‚   â”œâ”€â”€ LoginRequest.java
â”‚   â”‚   â”œâ”€â”€ RegisterRequest.java
â”‚   â”‚   â”œâ”€â”€ NoteRequest.java
â”‚   â”‚   â”œâ”€â”€ MindmapCreateRequest.java
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ entity/              # å®ä½“ç±»
â”‚   â”‚   â”œâ”€â”€ User.java
â”‚   â”‚   â”œâ”€â”€ Note.java
â”‚   â”‚   â”œâ”€â”€ Mindmap.java
â”‚   â”‚   â”œâ”€â”€ ChatSession.java
â”‚   â”‚   â”œâ”€â”€ ChatMessage.java
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ mapper/              # MyBatis Mapper
â”‚   â”‚   â”œâ”€â”€ UserMapper.java
â”‚   â”‚   â”œâ”€â”€ NoteMapper.java
â”‚   â”‚   â”œâ”€â”€ MindmapMapper.java
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ service/             # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â”œâ”€â”€ impl/
â”‚   â”‚   â”œâ”€â”€ UserService.java
â”‚   â”‚   â”œâ”€â”€ NoteService.java
â”‚   â”‚   â”œâ”€â”€ MindmapService.java
â”‚   â”‚   â”œâ”€â”€ EnhancedAiService.java    # AI å¢å¼ºæœåŠ¡
â”‚   â”‚   â””â”€â”€ RagService.java           # RAG æ£€ç´¢æœåŠ¡
â”‚   â”‚
â”‚   â””â”€â”€ util/                # å·¥å…·ç±»
â”‚       â”œâ”€â”€ JwtUtil.java
â”‚       â””â”€â”€ OssUtil.java
â”‚
â””â”€â”€ src/main/resources/
    â”€â”€ application.yml      # é…ç½®æ–‡ä»¶
```

### å‰ç«¯ç»“æ„

```
AIKnowledgeBaseFrontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ assets/              # é™æ€èµ„æº
â”‚   â”‚   â””â”€â”€ styles/          # æ ·å¼æ–‡ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ components/          # ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Captcha.vue           # æ»‘åŠ¨éªŒè¯ç ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ MarkdownEditor.vue    # Markdown ç¼–è¾‘å™¨
â”‚   â”‚   â”œâ”€â”€ MindMapEditor.vue     # æ€ç»´å¯¼å›¾ç¼–è¾‘å™¨
â”‚   â”‚   â”œâ”€â”€ ChatWindow.vue        # AI èŠå¤©çª—å£
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ layouts/             # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â””â”€â”€ MainLayout.vue        # ä¸»å¸ƒå±€
â”‚   â”‚
â”‚   â”œâ”€â”€ router/              # è·¯ç”±é…ç½®
â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ http.js              # HTTP è¯·æ±‚å°è£…
â”‚   â”‚
â”‚   â”œâ”€â”€ views/               # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Login.vue            # ç™»å½•é¡µ
â”‚   â”‚   â”œâ”€â”€ Register.vue         # æ³¨å†Œé¡µ
â”‚   â”‚   â”œâ”€â”€ Notes.vue            # ç¬”è®°åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ NoteDetail.vue       # ç¬”è®°è¯¦æƒ…
â”‚   â”‚   â”œâ”€â”€ Mindmaps.vue         # æ€ç»´å¯¼å›¾åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ MindmapDetail.vue    # æ€ç»´å¯¼å›¾è¯¦æƒ…
â”‚   â”‚   â”œâ”€â”€ AIChat.vue           # AI å¯¹è¯
â”‚   â”‚   â”œâ”€â”€ Links.vue            # é“¾æ¥æ”¶è—
â”‚   â”‚   â”œâ”€â”€ Profile.vue          # ä¸ªäººèµ„æ–™
â”‚   â”‚   â””â”€â”€ KnowledgeContent.vue # çŸ¥è¯†åº“å†…å®¹
â”‚   â”‚
â”‚   â”œâ”€â”€ App.vue              # æ ¹ç»„ä»¶
â”‚   â””â”€â”€ main.js              # å…¥å£æ–‡ä»¶
â”‚
â”œâ”€â”€ index.html               # HTML æ¨¡æ¿
â”œâ”€â”€ package.json             # ä¾èµ–é…ç½®
â””â”€â”€ vite.config.js           # Vite é…ç½®
```

---

## API æ–‡æ¡£

### è®¿é—® Swagger UI

å¯åŠ¨åç«¯åï¼Œè®¿é—®ï¼š
- Swagger UI: `http://localhost:8081/swagger-ui.html`
- Knife4j UI: `http://localhost:8081/doc.html`

### 1. æ€ç»´å¯¼å›¾ç¼–è¾‘å™¨
åŸºäº jsMind å®ç°ï¼Œæ”¯æŒèŠ‚ç‚¹å¢åˆ æ”¹ã€å¤‡æ³¨ã€å›¾ç‰‡é™„ä»¶ï¼Œå…¼å®¹ XMind æ ¼å¼å¯¼å…¥å¯¼å‡ºã€‚

### 2. Markdown ç¼–è¾‘å™¨
å®æ—¶é¢„è§ˆã€è¯­æ³•é«˜äº®ã€å›¾ç‰‡æ‹–æ‹½ä¸Šä¼ è‡³é˜¿é‡Œäº‘ OSSã€å…¨å±ç¼–è¾‘æ¨¡å¼ã€‚

---

##  é…ç½®è¯´æ˜

### å¿…éœ€é…ç½®

1. **æ•°æ®åº“é…ç½®**
   - MySQL 8.0+ æ•°æ®åº“
   - åˆ›å»ºæ•°æ®åº“ `aiknowledgebase`
   - é…ç½®ç”¨æˆ·åå’Œå¯†ç 

2. **Redis é…ç½®**
   - Redis 7.x+ æœåŠ¡
   - é…ç½®è¿æ¥ä¿¡æ¯

3. **é˜¿é‡Œäº‘é€šä¹‰åƒé—® API**
   - æ³¨å†Œé˜¿é‡Œäº‘è´¦å·
   - å¼€é€šé€šä¹‰åƒé—®æœåŠ¡
   - è·å– API Key

4. **é˜¿é‡Œäº‘ OSS**
   - åˆ›å»º OSS Bucket
   - è·å– AccessKey ID å’Œ Secret
   - é…ç½® Bucket åç§°å’Œ Endpoint

5. **JWT Secret**
   - ç”Ÿæˆè‡³å°‘ 256 ä½çš„å¯†é’¥
   - é…ç½®åœ¨ `application.yml` ä¸­

### å¯é€‰é…ç½®

- **æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶**ï¼šé»˜è®¤ 10MB
- **Token è¿‡æœŸæ—¶é—´**ï¼šé»˜è®¤ 7 å¤©
- **AI æ¨¡å‹å‚æ•°**ï¼štemperatureã€model ç­‰

## å¼€å‘è§„èŒƒ

### ä»£ç è§„èŒƒ

- **åç«¯**ï¼šéµå¾ªé˜¿é‡Œå·´å·´ Java å¼€å‘è§„èŒƒ
- **å‰ç«¯**ï¼šéµå¾ª Vue 3 å®˜æ–¹é£æ ¼æŒ‡å—
- **å‘½å**ï¼šä½¿ç”¨æœ‰æ„ä¹‰çš„å˜é‡åå’Œå‡½æ•°å
- **æ³¨é‡Š**ï¼šå…³é”®é€»è¾‘æ·»åŠ æ³¨é‡Šè¯´æ˜

---

## ğŸ¯ æ ¸å¿ƒæŠ€æœ¯äº®ç‚¹

### 1. RAG æ£€ç´¢å¢å¼ºç”Ÿæˆç³»ç»Ÿ

**ä¸šåŠ¡æµç¨‹**ï¼š
1. ç”¨æˆ·æé—®æ—¶ï¼Œç³»ç»Ÿä»ç”¨æˆ·é—®é¢˜ä¸­æå–å…³é”®è¯
2. åœ¨ç¬”è®°å’Œæ€ç»´å¯¼å›¾çš„å†…å­˜ç´¢å¼•ä¸­è¿›è¡Œç›¸å…³æ€§æ£€ç´¢
3. å°†æ£€ç´¢åˆ°çš„å†…å®¹æ³¨å…¥åˆ° AI Prompt ä¸­
4. AI åŸºäºæœ¬åœ°çŸ¥è¯†åº“å†…å®¹ç”Ÿæˆå›ç­”

**å®ç°æ–¹å¼**ï¼š
- **ç´¢å¼•ç»“æ„**ï¼šä½¿ç”¨ `ConcurrentHashMap<Long, List<Index>>` ä¸ºæ¯ä¸ªç”¨æˆ·ç»´æŠ¤ç‹¬ç«‹çš„å†…å­˜ç´¢å¼•ï¼ŒåŒ…å«ç¬”è®°ç´¢å¼•å’Œæ€ç»´å¯¼å›¾ç´¢å¼•
- **å…³é”®è¯æå–**ï¼šé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼åˆ†è¯ï¼Œè¿‡æ»¤ä¸­è‹±æ–‡åœç”¨è¯ï¼ˆçº¦ 60 ä¸ªå¸¸è§åœç”¨è¯ï¼‰ï¼Œæå–é•¿åº¦ â‰¥2 çš„æœ‰æ•ˆè¯æ±‡
- **ç›¸å…³æ€§ç®—æ³•**ï¼š
  - æ ‡é¢˜å®Œå…¨åŒ¹é…ï¼š+10 åˆ†
  - æ ‡é¢˜å…³é”®è¯åŒ¹é…ï¼š+8 åˆ†
  - åˆ†ç±»åŒ¹é…ï¼š+5 åˆ†ï¼ˆå®Œå…¨ï¼‰/ +3 åˆ†ï¼ˆå…³é”®è¯ï¼‰
  - å†…å®¹å…³é”®è¯åŒ¹é…ï¼š+3 åˆ† + é¢å¤–åŒ¹é…æ•° * 0.5 åˆ†
  - å…³é”®è¯é‡å åº¦ï¼š(é‡å æ•° / æŸ¥è¯¢è¯æ•°) * 2 åˆ†
- **Prompt æ³¨å…¥**ï¼šå°†æ£€ç´¢ç»“æœæ ¼å¼åŒ–ä¸º "ã€ç›¸å…³ç¬”è®°ã€‘" å’Œ "ã€ç›¸å…³æ€ç»´å¯¼å›¾ã€‘" ä¸¤éƒ¨åˆ†ï¼Œæ¯é¡¹å†…å®¹æˆªå–å‰ 1500 å­—ç¬¦ï¼Œé¿å… Token è¶…é™
- **è¾¹ç•Œæ§åˆ¶**ï¼šé€šè¿‡ System Prompt æ˜ç¡®è¦æ±‚ AI ä»…ä½¿ç”¨æä¾›çš„æœ¬åœ°å†…å®¹ï¼Œæ— ç›¸å…³å†…å®¹æ—¶è¿”å›å›ºå®šè¯æœ¯

### 2. å¼‚æ­¥ç´¢å¼•é‡å»ºä¸çº¿ç¨‹æ± ä¼˜åŒ–

**ä¸šåŠ¡æµç¨‹**ï¼š
1. ç”¨æˆ·ä¿®æ”¹ç¬”è®°/æ€ç»´å¯¼å›¾åï¼Œè§¦å‘ç´¢å¼•é‡å»ºè¯·æ±‚
2. æ¥å£ç«‹å³è¿”å› 200ms å“åº”ï¼Œç´¢å¼•é‡å»ºä»»åŠ¡æäº¤åˆ°å¼‚æ­¥çº¿ç¨‹æ± 
3. åå°çº¿ç¨‹æ± å¹¶å‘å¤„ç†ç´¢å¼•æ„å»ºï¼Œä¸é˜»å¡ç”¨æˆ·æ“ä½œ

**å®ç°æ–¹å¼**ï¼š
- **çº¿ç¨‹æ± é…ç½®**ï¼š
  - æ ¸å¿ƒçº¿ç¨‹æ•° = `Runtime.getRuntime().availableProcessors()`ï¼ˆCPU æ ¸å¿ƒæ•°ï¼‰
  - æœ€å¤§çº¿ç¨‹æ•° = CPU æ ¸å¿ƒæ•° * 2
  - é˜Ÿåˆ—å®¹é‡ = 100
  - æ‹’ç»ç­–ç•¥ = `CallerRunsPolicy`ï¼ˆç”±è°ƒç”¨çº¿ç¨‹æ‰§è¡Œï¼Œä¿è¯ä»»åŠ¡ä¸ä¸¢å¤±ï¼‰
- **å¼‚æ­¥æ³¨è§£**ï¼šä½¿ç”¨ `@Async("ragIndexExecutor")` æŒ‡å®šä¸“ç”¨çº¿ç¨‹æ± 
- **è¿”å›ç±»å‹**ï¼š`CompletableFuture<Void>` æ”¯æŒå¼‚æ­¥ç»“æœå¤„ç†
- **ä¼˜é›…å…³é—­**ï¼š`setWaitForTasksToCompleteOnShutdown(true)` + `setAwaitTerminationSeconds(60)`ï¼Œç¡®ä¿åº”ç”¨å…³é—­å‰ä»»åŠ¡å®Œæˆ

**æ€§èƒ½æ•°æ®**ï¼š
- ç´¢å¼•é‡å»ºæ¥å£å“åº”æ—¶é—´ï¼šä»åŒæ­¥æ‰§è¡Œçš„ 5-10 ç§’é™è‡³ 200ms ä»¥å†…
- å®é™…ç´¢å¼•æ„å»ºåœ¨åå°å®Œæˆï¼Œè€—æ—¶å–å†³äºç¬”è®°æ•°é‡ï¼ˆçº¦ 100-500msï¼‰

### 3. ä¸‰çº§é™æµé˜²æŠ¤ä½“ç³»

**ä¸šåŠ¡æµç¨‹**ï¼š
1. è¯·æ±‚åˆ°è¾¾æ—¶ï¼Œä¾æ¬¡é€šè¿‡å…¨å±€é™æµå™¨ â†’ AI æ¥å£é™æµå™¨ â†’ ç”¨æˆ·çº§é™æµå™¨
2. ä»»ä¸€é™æµå™¨æ‹’ç»è¯·æ±‚æ—¶ï¼Œè¿”å› HTTP 429 çŠ¶æ€ç å’Œå‹å¥½æç¤º
3. é€šè¿‡æ‰€æœ‰æ£€æŸ¥åï¼Œè¯·æ±‚è¿›å…¥ä¸šåŠ¡å¤„ç†

**å®ç°æ–¹å¼**ï¼š
- **é™æµå™¨ç±»å‹**ï¼šGuava `RateLimiter`ï¼ˆä»¤ç‰Œæ¡¶ç®—æ³•ï¼‰
- **ä¸‰çº§ç­–ç•¥**ï¼š
  - å…¨å±€é™æµï¼š`RateLimiter.create(1000.0)`ï¼Œé˜²æ­¢ç³»ç»Ÿæ•´ä½“è¿‡è½½
  - AI æ¥å£é™æµï¼š`RateLimiter.create(50.0)`ï¼Œä¿æŠ¤é«˜æˆæœ¬ AI æœåŠ¡
  - ç”¨æˆ·çº§é™æµï¼š`ConcurrentHashMap` åŠ¨æ€åˆ›å»ºï¼Œæ¯ç”¨æˆ· 100 QPS
- **ç”¨æˆ·è¯†åˆ«**ï¼šä» JWT Token çš„ hashCode æå–ç”¨æˆ·æ ‡è¯†ï¼ˆé¿å…å¾ªç¯ä¾èµ–ï¼‰
- **æ‹¦æˆªå™¨å®ç°**ï¼šåŸºäº Spring MVC `HandlerInterceptor`ï¼Œåœ¨ `preHandle` æ–¹æ³•ä¸­æ‰§è¡Œé™æµæ£€æŸ¥
- **æ’é™¤è·¯å¾„**ï¼šç™»å½•ã€æ³¨å†Œã€Swagger ç­‰æ¥å£ä¸é™æµ

### 4. å¤šè½®å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†

**ä¸šåŠ¡æµç¨‹**ï¼š
1. ç”¨æˆ·å‘é€æ¶ˆæ¯æ—¶ï¼Œä»å†…å­˜åŠ è½½è¯¥ä¼šè¯çš„å†å²æ¶ˆæ¯
2. ç§»é™¤æ—§çš„ System Promptï¼Œæ ¹æ®æ¨¡å¼ï¼ˆdefault/localï¼‰æ·»åŠ æ–°çš„ System Prompt
3. æ·»åŠ ç”¨æˆ·æ¶ˆæ¯ï¼Œä¿ç•™æœ€è¿‘ 20 æ¡æ¶ˆæ¯ï¼ˆæ»‘åŠ¨çª—å£ï¼‰
4. è°ƒç”¨ AI æ¥å£ï¼Œå°†å®Œæ•´å¯¹è¯å†å²ä½œä¸º messages å‚æ•°
5. å°† AI å›å¤å­˜å…¥å†…å­˜å’Œæ•°æ®åº“

**å®ç°æ–¹å¼**ï¼š
- **åŒå­˜å‚¨ç­–ç•¥**ï¼š
  - å†…å­˜ï¼š`ConcurrentHashMap<Long, List<Map<String, String>>>`ï¼Œkey ä¸º sessionId
  - æ•°æ®åº“ï¼š`chat_message` è¡¨æŒä¹…åŒ–æ‰€æœ‰æ¶ˆæ¯
- **æ»‘åŠ¨çª—å£**ï¼šå½“æ¶ˆæ¯æ•°è¶…è¿‡ 20 æ¡æ—¶ï¼Œä½¿ç”¨ `subList(size - 20, size)` æˆªå–æœ€è¿‘æ¶ˆæ¯
- **æ¨¡å¼åˆ‡æ¢**ï¼š
  - `default` æ¨¡å¼ï¼šSystem Prompt ä¸ºé€šç”¨åŠ©æ‰‹ï¼Œè¦æ±‚ Markdown æ ¼å¼å›å¤
  - `local` æ¨¡å¼ï¼šè°ƒç”¨ RAG æ£€ç´¢ï¼Œå°†æ£€ç´¢ç»“æœæ³¨å…¥ System Prompt
- **æµå¼å“åº”**ï¼šé€šè¿‡ Server-Sent Events (SSE) å®ç°ï¼Œè§£æ `data:` è¡Œï¼Œæå– `delta.content` å­—æ®µ

### 5. Redis ç¼“å­˜åŠ é€ŸæŸ¥è¯¢

**ä¸šåŠ¡æµç¨‹**ï¼š
1. æŸ¥è¯¢ç¬”è®°è¯¦æƒ…/å†…å®¹æ—¶ï¼Œå…ˆä» Redis è¯»å–
2. ç¼“å­˜å‘½ä¸­ç›´æ¥è¿”å›ï¼Œæœªå‘½ä¸­åˆ™æŸ¥è¯¢æ•°æ®åº“/OSS
3. æŸ¥è¯¢ç»“æœå†™å…¥ Redisï¼Œè®¾ç½® TTL
4. ç¬”è®°ä¿®æ”¹/åˆ é™¤æ—¶ï¼Œæ¸…é™¤ç›¸å…³ç¼“å­˜

**å®ç°æ–¹å¼**ï¼š
- **ç¼“å­˜é”®è®¾è®¡**ï¼š
  - ç¬”è®°è¯¦æƒ…ï¼š`note:detail:{noteId}`
  - ç¬”è®°å†…å®¹ï¼š`note:content:{noteId}`
  - ç”¨æˆ·ç¬”è®°åˆ—è¡¨ï¼š`note:list:{userId}`
- **ç¼“å­˜ç­–ç•¥**ï¼šCache-Asideï¼ˆæ—è·¯ç¼“å­˜ï¼‰ï¼Œè¯»æ—¶åŠ è½½ï¼Œå†™æ—¶å¤±æ•ˆ
- **TTL è®¾ç½®**ï¼šé€šè¿‡ `RedisConstants.NOTE_CACHE_TTL` ç»Ÿä¸€ç®¡ç†è¿‡æœŸæ—¶é—´
- **ç¼“å­˜æ›´æ–°**ï¼šä¿®æ”¹ç¬”è®°æ—¶åˆ é™¤ `detail`ã€`content`ã€`list` ä¸‰ä¸ªç¼“å­˜é”®ï¼Œä¿è¯æ•°æ®ä¸€è‡´æ€§

### 6. JWT æ— çŠ¶æ€è®¤è¯

**ä¸šåŠ¡æµç¨‹**ï¼š
1. ç”¨æˆ·ç™»å½•æˆåŠŸåï¼Œç”Ÿæˆ JWT Token è¿”å›ç»™å‰ç«¯
2. å‰ç«¯æ¯æ¬¡è¯·æ±‚æºå¸¦ `Authorization: Bearer {token}` è¯·æ±‚å¤´
3. `JwtAuthenticationFilter` æ‹¦æˆªè¯·æ±‚ï¼ŒéªŒè¯ Token æœ‰æ•ˆæ€§
4. éªŒè¯é€šè¿‡åï¼Œä» Token ä¸­æå–ç”¨æˆ·ä¿¡æ¯ï¼Œè®¾ç½®åˆ° `SecurityContext`
5. Controller é€šè¿‡ `@AuthenticationPrincipal` è·å–å½“å‰ç”¨æˆ·

**å®ç°æ–¹å¼**ï¼š
- **Token ç”Ÿæˆ**ï¼šä½¿ç”¨ `io.jsonwebtoken` åº“ï¼ŒHS256 ç®—æ³•ç­¾å
- **å¯†é’¥ç®¡ç†**ï¼šä» `application.yml` è¯»å– `jwt.secret`ï¼ˆéœ€ â‰¥256 ä½ï¼‰
- **è¿‡æœŸæ—¶é—´**ï¼š`jwt.expiration` é…ç½®ï¼Œé»˜è®¤ 7 å¤©ï¼ˆ604800000 msï¼‰
- **å¯†ç åŠ å¯†**ï¼š`BCryptPasswordEncoder` åŠ å¯†å­˜å‚¨ï¼Œç™»å½•æ—¶éªŒè¯
- **æ•°æ®éš”ç¦»**ï¼šæ‰€æœ‰æŸ¥è¯¢æ·»åŠ  `eq(Entity::getUserId, userId)` æ¡ä»¶ï¼Œé˜²æ­¢è¶Šæƒè®¿é—®

### 7. æ»‘åŠ¨éªŒè¯ç é˜²æŠ¤

**ä¸šåŠ¡æµç¨‹**ï¼š
1. å‰ç«¯è¯·æ±‚éªŒè¯ç æ—¶ï¼Œåç«¯ç”Ÿæˆæ»‘å—æ‹¼å›¾éªŒè¯ç 
2. éªŒè¯ç æ•°æ®ï¼ˆåŸå›¾ã€æ»‘å—å›¾ã€åæ ‡ï¼‰å­˜å‚¨åˆ° Redisï¼Œ120 ç§’è¿‡æœŸ
3. ç”¨æˆ·æ‹–åŠ¨æ»‘å—ï¼Œå‰ç«¯å‘é€éªŒè¯è¯·æ±‚
4. åç«¯ä» Redis è¯»å–éªŒè¯æ•°æ®ï¼Œæ ¡éªŒæ»‘åŠ¨ä½ç½®ï¼ˆå…è®¸ Â±5 åƒç´ è¯¯å·®ï¼‰
5. éªŒè¯é€šè¿‡åï¼Œå…è®¸ç™»å½•/æ³¨å†Œæ“ä½œ

**å®ç°æ–¹å¼**ï¼š
- **éªŒè¯ç ç±»å‹**ï¼š`blockPuzzle`ï¼ˆæ»‘å—æ‹¼å›¾ï¼‰
- **ç¼“å­˜ç±»å‹**ï¼šRedisï¼Œé€šè¿‡ `aj.captcha.cache-type=redis` é…ç½®
- **è¯¯å·®èŒƒå›´**ï¼š`aj.captcha.slip-offset=5`ï¼Œå…è®¸ 5 åƒç´ åç§»
- **é›†æˆæ–¹å¼**ï¼šå¼•å…¥ `spring-boot-starter-captcha` ä¾èµ–ï¼Œè‡ªåŠ¨é…ç½®

---

##  æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| ç´¢å¼•é‡å»ºå“åº”æ—¶é—´ | â‰¤200ms | å¼‚æ­¥æ‰§è¡Œï¼Œæ¥å£ç«‹å³è¿”å› |
| å…¨å±€ QPS é™åˆ¶ | 1000 | é˜²æ­¢ç³»ç»Ÿè¿‡è½½ |
| AI æ¥å£ QPS é™åˆ¶ | 50 | æ§åˆ¶ AI æœåŠ¡æˆæœ¬ |
| å•ç”¨æˆ· QPS é™åˆ¶ | 100 | é˜²æ­¢æ¶æ„è¯·æ±‚ |
| ç¬”è®°ç¼“å­˜å‘½ä¸­ç‡ | çº¦ 70%+ | çƒ­ç‚¹æ•°æ®ç¼“å­˜ |
| æ»‘åŠ¨çª—å£æ¶ˆæ¯æ•° | 20 æ¡ | é¿å… Token è¶…é™ |

---

## License

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

##  è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

##  è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- æäº¤ Issue

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸€ä¸ª Starï¼â­**

